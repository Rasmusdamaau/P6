---
title: "Rasmus_data_analysis"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(vars)
library(tidyverse)
library(readxl)
library(urca)

```


```{r}

data("Canada")

Elspot_priser_2019 <- read_excel("C:/Users/rasmu/Dropbox/P-Sex/Data/Elspot-priser/Elspot-priser_2019.xlsx")

EL_forbrug_2019 <- read_excel("C:/Users/rasmu/Dropbox/P-Sex/Data/Elspot-priser/EL_forbrug_2019.xlsx")

EL_pris <- Elspot_priser_2019 %>% select(c(...1,DK1))
EL_forbrug <- EL_forbrug_2019

data <- bind_cols(EL_pris, EL_forbrug)

data <- inner_join(EL_pris, EL_forbrug,by = "...1") %>% `colnames<-`(c("date", "Price", "Consumption"))

d_ts <- as.ts(data[,-1])


summary(d_ts)

plot(d_ts, nc = 2, xlab = "")

adf1 <- summary(ur.df(d_ts[, "Price"], type = "trend", lags = 2))
adf1


adf2 <- summary(ur.df(diff(d_ts[, "Price"]), type = "drift", lags = 1))
adf2


VAR_result <- VARselect(d_ts, lag.max = 10, type = "both")
VAR_result$selection

p1ct <- VAR(d_ts, p = 1)
p1ct

summary(p1ct, equation = "Price")
summary(p1ct, equation = "Consumption")

plot(p1ct, names = "Price")
plot(p1ct, names = "Consumption")

ser11 <- serial.test(p1ct, lags.pt = 16, type = "PT.asymptotic")
ser11

norm1 <- normality.test(p1ct)
norm1$jb.mul
```




```{r}

co2_fuld <- read_excel("C:/Users/rasmu/Dropbox/P-Sex/Data/CO2/co2emis-dee2c245157047d6a4743124d7660ae6.xlsx")


co2 <- co2_fuld[,-c(1,3)]

out <- co2[(order(as.Date(co2$`43781.847222222219`))),]

ts_co2 <- as.ts(out[,-1])

plot(ts_co2)
```
















